<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-advanced-guides/server-client-sync">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Server-Client Sync | Reflex</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://littensy.github.io/reflex/img/social_card.png"><meta data-rh="true" name="twitter:image" content="https://littensy.github.io/reflex/img/social_card.png"><meta data-rh="true" property="og:url" content="https://littensy.github.io/reflex/docs/advanced-guides/server-client-sync"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Server-Client Sync | Reflex"><meta data-rh="true" name="description" content="Learn how to use broadcasters to sync state between the server and clients."><meta data-rh="true" property="og:description" content="Learn how to use broadcasters to sync state between the server and clients."><link data-rh="true" rel="icon" href="/reflex/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://littensy.github.io/reflex/docs/advanced-guides/server-client-sync"><link data-rh="true" rel="alternate" href="https://littensy.github.io/reflex/docs/advanced-guides/server-client-sync" hreflang="en"><link data-rh="true" rel="alternate" href="https://littensy.github.io/reflex/docs/advanced-guides/server-client-sync" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RB6KJ1M85Y-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Reflex" href="/reflex/opensearch.xml"><link rel="stylesheet" href="/reflex/assets/css/styles.c0a3f341.css">
<link rel="preload" href="/reflex/assets/js/runtime~main.d99b3ab5.js" as="script">
<link rel="preload" href="/reflex/assets/js/main.edd3121e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_NAB0" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/reflex/"><div class="navbar__logo"><img src="/reflex/img/logo.svg" alt="Reflex Logo" class="themedImage_Zodd themedImage--light_OQxR"><img src="/reflex/img/logo.svg" alt="Reflex Logo" class="themedImage_Zodd themedImage--dark_HCKq"></div><b class="navbar__title text--truncate">Reflex</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reflex/docs/">Learn</a><a class="navbar__item navbar__link" href="/reflex/docs/reference/reflex/">Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/littensy/reflex" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_HVLo colorModeToggle_MPlM"><button class="clean-btn toggleButton_WxxZ toggleButtonDisabled_kXev" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_HsUt"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_Mqoj"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ypbp"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_jX_Q docsWrapper_BTzr"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_W55J" type="button"></button><div class="docPage_ecK0"><aside class="theme-doc-sidebar-container docSidebarContainer_QPD9"><div class="sidebarViewport_cDNc"><div class="sidebar_xx1V"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_VvSw"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/reflex/docs/">Quick Start</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/reflex/docs/guides/">Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/reflex/docs/advanced-guides/">Advanced Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reflex/docs/advanced-guides/middleware">Middleware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reflex/docs/advanced-guides/server-client-sync">Server-Client Sync</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_YVPj"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_jO8Q"><div class="docItemContainer_MLiI"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xYkp" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/reflex/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_flTW"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/reflex/docs/advanced-guides/"><span itemprop="name">Advanced Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Server-Client Sync</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_P4c9 theme-doc-toc-mobile tocMobile_tWXV"><button type="button" class="clean-btn tocCollapsibleButton_WWnv">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Server-Client Sync</h1><p>Reflex provides a quick way to sync the server&#x27;s shared state with clients using <strong>broadcasters</strong> and <strong>receivers</strong>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_pbkD"><div class="admonitionHeading_GpQE"><span class="admonitionIcon_QGX8"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>what you&#x27;ll learn</div><div class="admonitionContent_Y2o7"><ul><li>üåé What shared producer slices are</li><li>üîó How to integrate shared slices into your state</li><li>üõ∞Ô∏è How to create broadcasters</li><li>üì° How to create receivers</li></ul></div></div><hr><h2 class="anchor anchorWithStickyNavbar_jD0q" id="sync-server-state-with-clients">Sync server state with clients<a href="#sync-server-state-with-clients" class="hash-link" aria-label="Direct link to Sync server state with clients" title="Direct link to Sync server state with clients">‚Äã</a></h2><p>Reflex is designed to be used in any environment, on the client and the server. However, in game development, many cases come up where you need to send state from the server to clients. This is where the concept of <strong>shared slices</strong> comes in.</p><h3 class="anchor anchorWithStickyNavbar_jD0q" id="sharing-state">Sharing state<a href="#sharing-state" class="hash-link" aria-label="Direct link to Sharing state" title="Direct link to Sharing state">‚Äã</a></h3><p>Shared slices are producers that are managed by the server and synced with clients. To create shared slices, we&#x27;ll follow this project structure:</p><div class="codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-text codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token plain">shared</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îú‚îÄ‚îÄ slices</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ calendar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ todos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îî‚îÄ‚îÄ remotes</span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Your shared <code>slices</code> module should look something like this:</p><div class="tabs-container tabList_t2F_"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_TXTv tabs__item--active">TypeScript</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_TXTv">Luau</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_rlDe"><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">shared/slices/index.ts</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">CombineStates</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;@rbxts/reflex&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> calendarSlice </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;./calendar&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> todosSlice </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;./todos&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">export</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:#116329">SharedState</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token maybe-class-name">CombineStates</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typeof</span><span class="token plain"> sharedSlices</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">export</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> sharedSlices </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    calendar</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> calendarSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    todos</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> todosSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_pbkD"><div class="admonitionHeading_GpQE"><span class="admonitionIcon_QGX8"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_Y2o7"><p>Exporting <code>SharedState</code> as a type makes it easier to create typed selectors without importing across the client/server boundary.</p><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">SharedState</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;shared/slices&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">export</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#8250DF">selectPlayers</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token maybe-class-name">SharedState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">players</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div role="tabpanel" class="tabItem_rlDe" hidden=""><div class="language-lua codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">shared/slices/init.lua</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-lua codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> Reflex </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReplicatedStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Packages</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reflex</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> calendar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">calendar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> todos </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">todos</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">export type SharedState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    calendar</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> calendar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CalendarState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    todos</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> todos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TodosState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">export type SharedActions </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> calendar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CalendarActions </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"> todos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TodosActions</span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    calendar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> calendar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">calendarSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    todos </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> todos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">todosSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_pbkD"><div class="admonitionHeading_GpQE"><span class="admonitionIcon_QGX8"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_Y2o7"><p>Exporting <code>SharedState</code> and <code>SharedActions</code> helps to build a fully-typed root producer.</p></div></div></div></div></div><p>In this example, we have two shared producer slices: <code>calendar</code> and <code>todos</code>. They are put together in a map and returned by <code>shared/slices</code>. The contents of these files are not important - they&#x27;re just like any other producer - but if you want to see how to write producers, <a href="/reflex/docs/guides/your-first-producer">check out this guide</a></p><p>Using a map of shared slices makes it easy to add them to your root producer. In your root producer file, you can import the shared slices and spread them into your root producer:</p><div class="tabs-container tabList_t2F_"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_TXTv tabs__item--active">TypeScript</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_TXTv">Luau</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_rlDe"><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Root producer</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">InferState</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> combineProducers </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;@rbxts/reflex&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> sharedSlices </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;shared/slices&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> fooSlice </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;./foo&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> barSlice </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;./bar&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">export</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">type</span><span class="token plain"> </span><span class="token class-name maybe-class-name" style="color:#116329">RootState</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token maybe-class-name">InferState</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token keyword" style="color:#CF222E">typeof</span><span class="token plain"> producers</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">export</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> producer </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">combineProducers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token spread operator" style="color:#D73A49">...</span><span class="token plain">sharedSlices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    foo</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> fooSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    bar</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> barSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_rlDe" hidden=""><div class="language-lua codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Root producer</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-lua codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> Reflex </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReplicatedStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Packages</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reflex</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> sharedSlices </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReplicatedStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shared</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">slices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> foo </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> bar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">export type RootProducer </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Reflex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Producer</span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain">RootState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RootActions</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">export type RootState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> producers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SharedState </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FooState </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BarState</span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">export type RootActions </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> producers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SharedActions </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FooActions </span><span class="token operator" style="color:#D73A49">&amp;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BarActions</span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> slices </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    foo </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fooSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    bar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">barSlice</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> slice </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> sharedSlices </span><span class="token keyword" style="color:#CF222E">do</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    slices</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> slice</span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> Reflex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">combineProducers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">::</span><span class="token plain"> RootProducer</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_pbkD"><div class="admonitionHeading_GpQE"><span class="admonitionIcon_QGX8"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_Y2o7"><p>Libraries like <a href="https://csqrl.github.io/sift/" target="_blank" rel="noopener noreferrer">Sift</a> can make it easier to merge tables in Luau.</p></div></div></div></div></div><p>Now that you have your shared state set up, and include them in both your client and server&#x27;s root producer, you can now use <a href="/reflex/docs/reference/reflex/create-broadcaster#createbroadcasteroptions"><code>createBroadcaster</code></a> to send state to clients.</p><h3 class="anchor anchorWithStickyNavbar_jD0q" id="creating-a-broadcaster">Creating a broadcaster<a href="#creating-a-broadcaster" class="hash-link" aria-label="Direct link to Creating a broadcaster" title="Direct link to Creating a broadcaster">‚Äã</a></h3><p>You should call <a href="/reflex/docs/reference/reflex/create-broadcaster#createbroadcasteroptions"><code>createBroadcaster</code></a> on the server when your game initializes, either before or after you create your root producer. It receives your shared producer map and a function that sends actions to the clients, and returns a broadcaster object. Make sure you&#x27;ve set up remotes as well:</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_pbkD"><div class="admonitionHeading_GpQE"><span class="admonitionIcon_QGX8"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>prerequisites</div><div class="admonitionContent_Y2o7"><p>You need remotes to use <a href="/reflex/docs/reference/reflex/create-broadcaster"><code>createBroadcaster</code></a>. We recommend <a href="http://rbxnet.australis.dev" target="_blank" rel="noopener noreferrer">RbxNet</a>, which is used in the examples on this page. You need to specify two remotes:</p><ul><li>A server event that sends actions to a clients. The type of this event would be <code>(actions: BroadcastAction[]) =&gt; void</code>.</li><li>A server function that returns the state of the root producer. The type of this function would be <code>(player: Player) =&gt; SharedState</code>.</li></ul></div></div><div class="tabs-container tabList_t2F_"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_TXTv tabs__item--active">TypeScript</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_TXTv">Luau</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_rlDe"><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Server</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> createBroadcaster </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;@rbxts/reflex&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> remotes </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;shared/remotes&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> sharedSlices </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;shared/slices&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> producer </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;./producer&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;broadcast&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> requestState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;requestState&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> broadcaster </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">createBroadcaster</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    producers</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> sharedSlices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token function-variable function" style="color:#8250DF">broadcast</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">players</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">        broadcast</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">SendToPlayers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">players</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">requestState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">SetCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> broadcaster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">playerRequestedState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">producer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">applyMiddleware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">broadcaster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">middleware</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_rlDe" hidden=""><div class="language-lua codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Server</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-lua codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> Reflex </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReplicatedStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Packages</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reflex</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> remotes </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReplicatedStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shared</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">remotes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> slices </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReplicatedStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shared</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">slices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> producer </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">script</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Parent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">producer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;broadcast&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> requestState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;requestState&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> broadcaster </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Reflex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">createBroadcaster</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    producers </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> slices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">players</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">        broadcast</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">SendToPlayers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">players</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">end</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">requestState</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">SetCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> broadcaster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">playerRequestedState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">producer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">applyMiddleware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">broadcaster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">middleware</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>This sets up a broadcaster that sends shared actions to the clients when they&#x27;re dispatched. It also connects a <code>requestState</code> remote that returns the state with <code>playerRequestedState</code>, which automatically filters out any state that the client doesn&#x27;t have access to.</p><p><a href="/reflex/docs/reference/reflex/create-broadcaster"><code>createBroadcaster</code></a> receives two options:</p><ol><li><code>producers</code>: Your <em>shared slices</em>. This is used to determine which state and actions should be sent to the client.</li><li><code>broadcast</code>: A user-defined callback that sends shared dispatched actions to the clients. It receives an array of actions and an array of players to send them to.</li></ol><p>It returns a broadcaster object, which has two properties:</p><ol><li><p><code>middleware</code>: A Reflex middleware that helps do some of the heavy lifting for you. You should apply this middleware to your root producer. If you have any middlewares that change dispatched arguments, you should apply them after this middleware to ensure that the arguments are preserved.</p></li><li><p><code>playerRequestedState</code>: A method that receives the player that requested state, and returns the shared part of the root producer&#x27;s state. It should only be called within a remote.</p></li></ol><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_pbkD"><div class="admonitionHeading_GpQE"><span class="admonitionIcon_QGX8"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>pitfall</div><div class="admonitionContent_Y2o7"><p><strong>Make sure your shared state can be sent over a remote!</strong> Objects that use non-string keys or certain values will not be sent over intact. See the <a href="/reflex/docs/reference/reflex/create-broadcaster#troubleshooting">troubleshooting</a> page for more information on this common pitfall.</p></div></div><h3 class="anchor anchorWithStickyNavbar_jD0q" id="creating-a-receiver">Creating a receiver<a href="#creating-a-receiver" class="hash-link" aria-label="Direct link to Creating a receiver" title="Direct link to Creating a receiver">‚Äã</a></h3><p>Once you have your broadcaster set up, you can use <a href="/reflex/docs/reference/reflex/create-broadcast-receiver#createbroadcastreceiveroptions"><code>createBroadcastReceiver</code></a> to initialize the client state with the server&#x27;s shared state and keep it in sync.</p><div class="tabs-container tabList_t2F_"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_TXTv tabs__item--active">TypeScript</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_TXTv">Luau</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_rlDe"><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Client</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword module" style="color:#CF222E">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> createBroadcastReceiver </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#CF222E">from</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;@rbxts/reflex&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;broadcast&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> requestState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;requestState&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> receiver </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">createBroadcastReceiver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token function-variable function" style="color:#8250DF">requestState</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> requestState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">CallServerAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">broadcast</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">Connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    receiver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">dispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">producer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">applyMiddleware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">receiver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">middleware</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_rlDe" hidden=""><div class="language-lua codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Client</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-lua codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu codeBlockLinesWithNumbering_ygxi"><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> Reflex </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ReplicatedStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Packages</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reflex</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;broadcast&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> requestState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;requestState&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> receiver </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Reflex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">createBroadcastReceiver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    requestState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> requestState</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">CallServerAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">end</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">broadcast</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">Connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">    receiver</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">dispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_iNdf" style="color:#393A34"><span class="codeLineNumber_E1Rq"></span><span class="codeLineContent_qC2S"><span class="token plain">producer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">applyMiddleware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">receiver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">middleware</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>This code will call <code>requestState</code> when the middleware is applied, and merge the server&#x27;s shared state with the client&#x27;s state. You should also connect the receiver&#x27;s <code>dispatch</code> method to the remote, so that the state continues to be kept in sync.</p><p><strong>It&#x27;s thread-safe,</strong> as you can set up <code>createBroadcastReceiver</code> in a script separate from your producer and it will work as long as you apply the middleware to the producer and connect the receiver&#x27;s <code>dispatch</code> method to the remote.</p><p>It&#x27;s safe to apply the middleware at any time, and you can even use your producer before the server&#x27;s state is received.</p><hr><h2 class="anchor anchorWithStickyNavbar_jD0q" id="recipes">Recipes<a href="#recipes" class="hash-link" aria-label="Direct link to Recipes" title="Direct link to Recipes">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_jD0q" id="filtering-state-before-sending-it-to-a-client">Filtering state before sending it to a client<a href="#filtering-state-before-sending-it-to-a-client" class="hash-link" aria-label="Direct link to Filtering state before sending it to a client" title="Direct link to Filtering state before sending it to a client">‚Äã</a></h3><p>In your broadcaster, you have control over what the client receives when they request state. You can write a function that filters out any state that the client doesn&#x27;t have access to.</p><p>Here, let&#x27;s filter a <code>playerData</code> slice to only include the data of the player that requested state:</p><div class="tabs-container tabList_t2F_"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_TXTv tabs__item--active">TypeScript</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_TXTv">Luau</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_rlDe"><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Server</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">filterPlayerData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token maybe-class-name">Player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token maybe-class-name">SharedState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token spread operator" style="color:#D73A49">...</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        playerData</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">playerData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#808080;font-style:normal">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requestState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">SetCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> broadcaster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">playerRequestedState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">filterPlayerData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_rlDe" hidden=""><div class="language-lua codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Server</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-lua codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">filterPlayerData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> filteredState </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    filteredState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">playerData </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">playerData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> filteredState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#808080;font-style:normal">-- ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requestState</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">SetCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> broadcaster</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">playerRequestedState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">filterPlayerData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">end</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_jD0q" id="filtering-actions-before-sending-them-to-a-player">Filtering actions before sending them to a player<a href="#filtering-actions-before-sending-them-to-a-player" class="hash-link" aria-label="Direct link to Filtering actions before sending them to a player" title="Direct link to Filtering actions before sending them to a player">‚Äã</a></h3><p>You can also filter actions before sending them to a player, which is useful for things like private player data. This is done by modifying the <code>actions</code> array in the <code>broadcast</code> callback.</p><p>We&#x27;ll write a function that only broadcasts player data actions if the first <code>name</code> argument of an action is the same as the player that is receiving the action:</p><div class="tabs-container tabList_t2F_"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_TXTv tabs__item--active">TypeScript</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_TXTv">Luau</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_rlDe"><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Action filter</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">findPlayerName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token builtin">unknown</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#808080;font-style:normal">// Search for a valid username in the arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> value </span><span class="token keyword" style="color:#CF222E">of</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#8250DF">typeIs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&amp;&amp;</span><span class="token plain"> </span><span class="token maybe-class-name">Players</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">FindFirstChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">createPlayerNameFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#D73A49">...</span><span class="token plain">actions</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">readonly</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token maybe-class-name">Callback</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> names </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name" style="color:#116329">Set</span><span class="token class-name operator" style="color:#D73A49">&lt;</span><span class="token class-name builtin" style="color:#116329">string</span><span class="token class-name operator" style="color:#D73A49">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#808080;font-style:normal">// Create a set of all the action names that we want to filter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> actionMap </span><span class="token keyword" style="color:#CF222E">of</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> name </span><span class="token keyword" style="color:#CF222E">of</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:#116329">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">keys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">actionMap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            names</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token maybe-class-name">Player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token maybe-class-name">BroadcastAction</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#808080;font-style:normal">// Filter out actions if they are a player data action and this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#808080;font-style:normal">// player isn&#x27;t the target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">// If the action name isn&#x27;t in the set, keep it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">!</span><span class="token plain">names</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">has</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">// Search for a valid username in the arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">findPlayerName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">arguments</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">// If the action doesn&#x27;t have a valid username, keep it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">// Otherwise, only keep the action if the username matches</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#CF222E">return</span><span class="token plain"> name </span><span class="token operator" style="color:#D73A49">===</span><span class="token plain"> </span><span class="token keyword nil" style="color:#CF222E">undefined</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">||</span><span class="token plain"> name </span><span class="token operator" style="color:#D73A49">===</span><span class="token plain"> player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> playerDataFilter </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">createPlayerNameFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">playerDataSlice</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#8250DF">getActions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-ts codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Server</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-ts codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Server</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;broadcast&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> broadcaster </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">createBroadcaster</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    producers</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> sharedSlices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#8250DF">broadcast</span><span class="token operator" style="color:#D73A49">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">players</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#D73A49">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#CF222E">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> player </span><span class="token keyword" style="color:#CF222E">of</span><span class="token plain"> players</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">const</span><span class="token plain"> filteredActions </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">playerDataFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            broadcast</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#8250DF">SendToPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filteredActions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_rlDe" hidden=""><div class="language-lua codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Action filter</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-lua codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">findPlayerName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> any </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#808080;font-style:normal">-- Search for a valid username in the arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> args </span><span class="token keyword" style="color:#CF222E">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">type</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;string&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">and</span><span class="token plain"> Players</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">FindFirstChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">function</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">createPlayerNameFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">-</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> any </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> names</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> boolean </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#808080;font-style:normal">-- Create a set of all the action names that we want to filter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actionMap </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> name </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> actionMap </span><span class="token keyword" style="color:#CF222E">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            names</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> filteredActions </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#808080;font-style:normal">-- Filter out actions if they are a player data action and this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#808080;font-style:normal">-- player isn&#x27;t the target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> actions </span><span class="token keyword" style="color:#CF222E">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">-- If the action name isn&#x27;t in the set, keep it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> names</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                table</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filteredActions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                continue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">-- Search for a valid username in the arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">findPlayerName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">-- If the action doesn&#x27;t have a valid username, keep it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#808080;font-style:normal">-- Otherwise, only keep the action if the username matches</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> name </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">nil</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">or</span><span class="token plain"> name </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> player</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name </span><span class="token keyword" style="color:#CF222E">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                table</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filteredActions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> filteredActions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> playerDataFilter </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">createPlayerNameFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">playerDataSlice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">getActions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-lua codeBlockContainer_qKi4 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#ffffff"><div class="codeBlockTitle_tjLP">Server</div><div class="codeBlockContent_eGfQ"><pre tabindex="0" class="prism-code language-lua codeBlock_Id3g thin-scrollbar"><code class="codeBlockLines_UQKu"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> remotes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;broadcast&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> broadcaster </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Reflex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#8250DF">createBroadcaster</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    producers </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> sharedSlices</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    broadcast </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">players</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> player </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> players </span><span class="token keyword" style="color:#CF222E">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">local</span><span class="token plain"> filteredActions </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">playerDataFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            broadcast</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#8250DF">SendToPlayer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">player</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filteredActions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">end</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_FwZQ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_zn7T" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_Puu5"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_K6gp"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_pbkD"><div class="admonitionHeading_GpQE"><span class="admonitionIcon_QGX8"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_Y2o7"><p>You can rewrite the <code>findPlayerName</code> function to be more specific to your use case. For example, if you want to filter by user ID instead of username, you can use <code>Players.GetPlayerByUserId</code> instead of <code>Players.FindFirstChild</code>.</p></div></div><hr><h2 class="anchor anchorWithStickyNavbar_jD0q" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">‚Äã</a></h2><ul><li>Shared state is synced between the server and client using a broadcaster and a receiver.</li><li>The <strong>broadcaster</strong> is responsible for sending state and actions to the receiver.</li><li>The <strong>receiver</strong> is responsible for dispatching actions from the broadcaster.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reflex/docs/advanced-guides/middleware"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Middleware</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_iSsM thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sync-server-state-with-clients" class="table-of-contents__link toc-highlight">Sync server state with clients</a><ul><li><a href="#sharing-state" class="table-of-contents__link toc-highlight">Sharing state</a></li><li><a href="#creating-a-broadcaster" class="table-of-contents__link toc-highlight">Creating a broadcaster</a></li><li><a href="#creating-a-receiver" class="table-of-contents__link toc-highlight">Creating a receiver</a></li></ul></li><li><a href="#recipes" class="table-of-contents__link toc-highlight">Recipes</a><ul><li><a href="#filtering-state-before-sending-it-to-a-client" class="table-of-contents__link toc-highlight">Filtering state before sending it to a client</a></li><li><a href="#filtering-actions-before-sending-them-to-a-player" class="table-of-contents__link toc-highlight">Filtering actions before sending them to a player</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/reflex/docs">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/reflex/docs/quick-start/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/reflex/docs/guides">Guides</a></li></ul></div><div class="col footer__col"><div class="footer__title">API Reference</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/reflex/docs/reference/reflex">Reflex API</a></li><li class="footer__item"><a class="footer__link-item" href="/reflex/docs/reference/roact-reflex">Roact Reflex API</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.roblox-ts.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Roblox-TS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_yhlY"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/Bcyh8kmRYe" target="_blank" rel="noopener noreferrer" class="footer__link-item">Roblox OSS Community<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_yhlY"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/littensy/reflex" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_yhlY"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2023 Richard L</div></div></div></footer></div>
<script src="/reflex/assets/js/runtime~main.d99b3ab5.js"></script>
<script src="/reflex/assets/js/main.edd3121e.js"></script>
</body>
</html>